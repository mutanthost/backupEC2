SELECT * FROM 
(select ips.IP FROM
        (SELECT c.ID as id, A.IPADDRESS as ip FROM VDO_ETHER_PORT_INFO A, VMB_SERVER_ETHPORINF B, VMB_SERVER C
        WHERE A.IPADDRESS IS NOT NULL AND A.ID = B.ETHPORINF_ID AND B.ID = C.ID AND upper(C.MODEL) LIKE '%VIRTUAL%MACHINE%'
        ORDER BY A.IPADDRESS, C.ID) IPS,
        (
        SELECT NAME, IP, SUBNETMASK, ROWNUM AS NAMEIDX FROM
          (SELECT B.USEFRINAM as name, A.IPADDRESS as ip, a.SUBNETMASK as subnetmask
          FROM VMB_NETWORK A, VMB_MANAGED_RESOURC B 
          WHERE 
            A.ID=B.ID AND
            UPPER(B.USEFRINAM) LIKE '%ETH-ADMIN%'
            ORDER BY  TO_NUMBER (REGEXP_SUBSTR (A.IPADDRESS, '[0-9]+', 1, 1))	ASC
            ,     	  TO_NUMBER (REGEXP_SUBSTR (A.IPADDRESS, '[0-9]+', 1, 2))	ASC
            ,     	  TO_NUMBER (REGEXP_SUBSTR (A.IPADDRESS, '[0-9]+', 1, 3))	ASC
            ,     	  TO_NUMBER (REGEXP_SUBSTR (A.IPADDRESS, '[0-9]+', 1, 4))	ASC)
        ) network_name
    WHERE
        BITAND(TO_NUMBER (REGEXP_SUBSTR (IPS.IP, '[0-9]+', 1, 1)), TO_NUMBER (REGEXP_SUBSTR (NETWORK_NAME.SUBNETMASK, '[0-9]+', 1, 1))) = TO_NUMBER (REGEXP_SUBSTR (NETWORK_NAME.IP, '[0-9]+', 1, 1)) AND
        BITAND(TO_NUMBER (REGEXP_SUBSTR (IPS.IP, '[0-9]+', 1, 2)), TO_NUMBER (REGEXP_SUBSTR (NETWORK_NAME.SUBNETMASK, '[0-9]+', 1, 2))) = TO_NUMBER (REGEXP_SUBSTR (NETWORK_NAME.IP, '[0-9]+', 1, 2)) AND
        BITAND(TO_NUMBER (REGEXP_SUBSTR (IPS.IP, '[0-9]+', 1, 3)), TO_NUMBER (REGEXP_SUBSTR (NETWORK_NAME.SUBNETMASK, '[0-9]+', 1, 3))) = TO_NUMBER (REGEXP_SUBSTR (NETWORK_NAME.IP, '[0-9]+', 1, 3)) AND
        BITAND(TO_NUMBER (REGEXP_SUBSTR (IPS.IP, '[0-9]+', 1, 4)), TO_NUMBER (REGEXP_SUBSTR (NETWORK_NAME.SUBNETMASK, '[0-9]+', 1, 4))) = TO_NUMBER (REGEXP_SUBSTR (NETWORK_NAME.IP, '[0-9]+', 1, 4))
    ORDER BY  TO_NUMBER (REGEXP_SUBSTR (IPS.IP, '[0-9]+', 1, 1))	ASC
        ,     	  TO_NUMBER (REGEXP_SUBSTR (IPS.IP, '[0-9]+', 1, 2))	ASC
        ,     	  TO_NUMBER (REGEXP_SUBSTR (IPS.IP, '[0-9]+', 1, 3))	ASC
        ,     	  TO_NUMBER (REGEXP_SUBSTR (IPS.IP, '[0-9]+', 1, 4))	ASC        
) WHERE ROWNUM<2
;     