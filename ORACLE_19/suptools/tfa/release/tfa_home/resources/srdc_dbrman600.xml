<?xml version="1.0"?>

<!--  $Header: tfa/src/v2/tfa_home/resources/srdc_dbrman600.xml /main/2 2018/08/15 16:55:52 bburton Exp $ -->

<!-- 
 Copyright (c) 2018, Oracle and/or its affiliates. All rights reserved.

   NAME
     srdc_dbrman600.xml 

   DESCRIPTION
     None 

   NOTES
     None 

   MODIFIED   (MM/DD/YY)
   xiaodowu    07/26/18 - Enable ONERROR verify on ORA600
   xiaodowu    01/19/18 - Add standard syntax for user prompts
   xiaodowu    01/18/18 - Implement Doc ID: 2045195.1 (SRDC - Required
                          diagnostic data collection for RMAN-00600 error).
   xiaodowu    01/18/18 - Creation

-->
<collections>
	<collection id="dbrman600">
		<description>SRDC - Required diagnostic data collection for RMAN-00600 error (Doc ID 2045195.1).</description>
		<alias>dbrman600</alias>
		<onevents>
			<event>
				<onerror>ORA-00600</onerror>
				<infile>
					<name_patterns>
						<pattern>alert_.*\.log</pattern>
					</name_patterns>
				</infile>
			</event>
		</onevents>
		<user_inputs>
			<user_input cmdline="" default="" showprompt="1" setenv="NO" validate="" prompt="Enter the Database Name">USERINPUT-DATABASE_NAME</user_input>
			<user_input cmdline="" default="Y" showprompt="1" setenv="NO" validate="Y|y|N|n" prompt="">USERINPUT-ONERROR_VERIFY</user_input>
	<user_input cmdline="" default="" showprompt="1" setenv="REPLACE" validate="(y|Y|n|N)" prompt="Have you executed your rman command in debug mode? [Y|N] ">USERINPUT-DEBUG</user_input>
			<user_input cmdline="" default="" showprompt="1" setenv="REPLACE" validate="file" prompt="Provide the full path and name of your rman script file: (the my_rman.rcv file in rman debug trace=my_rman.trc target / cmdfile=my_rman.rcv log=my_rman.log)">USERINPUT-RMAN_FILE</user_input>
			<user_input cmdline="" default="" showprompt="1" setenv="REPLACE" validate="file" prompt="Provide the full path and name of your rman output file: (the my_rman.log file in the above command line)">USERINPUT-LOG_FILE</user_input>
			<user_input cmdline="" default="" showprompt="1" setenv="REPLACE" validate="file" depinput="DEBUG" deppattern="y|Y" prompt="Provide the full path and name of your rman debug trace file: (the my_rman.trc file in the above command line)">USERINPUT-TRACE_FILE</user_input>
     <user_input cmdline="OPT" default="" showprompt="1" setenv="REPLACE" validate="(y|Y|n|N)" depinput="DEBUG" deppattern="n|N" prompt="Oracle Support often asks for running RMAN command in debug mode. Please consider doing so and come back to load the trace file. LBREAKRemember to include:LBREAKset echo on; LBREAKand LBREAKexport NLS_DATE_FORMAT='YYYY-MM-DD HH24:MI:SS' LBREAKAcknowledged? [Y|N] ">USERINPUT-SUGGESTION</user_input>
		</user_inputs>    
		<duration>12h</duration>
		<clusterwide>no</clusterwide>
		<filter_files>
			<types>
			</types>
			<filter_file_patterns>
				<filter_file_pattern>alert_.*\.log</filter_file_pattern>
				<filter_file_pattern>trc</filter_file_pattern>
				<filter_file_pattern>log</filter_file_pattern>
				<filter_file_pattern>archive\/osw</filter_file_pattern>
				<filter_file_pattern>ExaWatcher\/archive</filter_file_pattern>
			</filter_file_patterns>
			<filter_file_exclude_patterns>
				<filter_file_exclude_pattern>cdmp_.*_bucket\.tr[cm]</filter_file_exclude_pattern>
			</filter_file_exclude_patterns>
		</filter_files>
		<components>
			<component>OS</component>
			<component>CRS</component>
			<component>DATABASE</component>
			<component>NOCHMOS</component>
		</components>
		<commands>
			<script type="OS" name="cp_rman_script" timeout="120" validfor="" platform="allux" version="">
       /bin/cp %RMAN_FILE% srdc_rman_600_script_`date +%F`.txt
			</script>
			<script type="OS" name="cp_rman_log" timeout="120" validfor="" platform="allux" version="">
       /bin/cp %LOG_FILE% srdc_rman_600_output_`date +%F`.txt
			</script>
			<script type="OS" name="cp_rman_trace" timeout="120" validfor="" platform="allux" version="" depinput="DEBUG" deppattern="Y|y">
       /bin/cp %TRACE_FILE% srdc_rman_600_debug_`date +%F`.trc
			</script>
			<script type="IPSPACK" name="ipspack" timeout="120" validfor="" depinput="ONERROR_VERIFY" deppattern="y|Y" platform="" version="">
			</script>
			<script type="TFACTL" name="rdahcve1210" timeout="120" validfor="" platform="" version="12.1">
            tfactl run darda run rda_HCVE_12_1_0 menu menus/oracle_database.xml
			</script>
			<script type="TFACTL" name="rdahcve1120" timeout="120" validfor="" platform="" version="11.2">
            tfactl run darda run rda_HCVE_11_2 menu menus/oracle_database.xml
			</script>
			<script type="TFACTL" name="rdahcve1110" timeout="120" validfor="" platform="" version="11.1">
            tfactl run darda run rda_HCVE_11_1 menu menus/oracle_database.xml
			</script>
		</commands>
		<runtime_flags>
		</runtime_flags>
	</collection>
</collections>
