#!/bin/sh

# Copyright (c) 2001, 2018, Oracle and/or its affiliates. All rights reserved.
#
#    NAME
#      oidprovtool: Performs Provisioning Subscription
#
#    DESCRIPTION
#
#    MODIFIED   (MM/DD/YY)
#    vijana 07/28/10 - XbranchMerge vijanaki_fix_oidprovtool_issue from
#                      st_ldap_db11.2
#    tashah 10/15/06 - removing audit property from command line
#    tashah 10/09/06 - Adding jps in class path
#    tashah 09/21/06 - Adding madintegrator in classpath
#    btridi 06/07/06 - 5728800
#    skatti 05/10/06 - bug 5145504: product line merge 
#    tnalla 10/05/04 - bug 3933094 - set ld_library_path correctly 
#    tylee  07/14/04 - fix 32bit-64bit library path 
#    rbollu 06/25/04 - fix PE.3722298 
#    btridi 07/08/03 - 2995472
#    akolli 03/04/03 - change jclnt jar name
#    vasokk 01/22/03 - Add SSL classes
#    akolli 11/01/01 - fix bug 2022475
#    vasokk 09/28/01 - Merged vasokkum_engine11
#    akolli 09/28/01 - Created
#

# ORACLE_HOME must be set and the directory must exist.
# if it is already defined as an environment variable that will be used.

if [ "${ORACLE_HOME}" = "" ]; then
   ORACLE_HOME=/u01/app/oracle/product/19.0.0/dbhome_1
   export ORACLE_HOME
fi

if [ ! -d "${ORACLE_HOME}" ]; then
   echo "$ORACLE_HOME directory does not exist. Please verify"
   exit
fi
# A few platforms use an environment variable other than LD_LIBRARY_PATH
SET_DEFAULT=YES
PLATFORM=`uname`
M_ARCH=`uname -m`
if [ "$PLATFORM" = Linux -a "$M_ARCH" = s390x ]; then
  SET_DEFAULT=NO
  LD_LIBRARY_PATH=$ORACLE_HOME/lib32:$ORACLE_HOME/network/lib32:$LD_LIBRARY_PATH
  export LD_LIBRARY_PATH
fi
case $PLATFORM in "HP-UX")
   SET_DEFAULT=NO
   SHLIB_PATH=$ORACLE_HOME/lib32:$ORACLE_HOME/network/lib32:$SHLIB_PATH
   export SHLIB_PATH
esac
case $PLATFORM in "AIX")
   SET_DEFAULT=NO
   LIBPATH=$ORACLE_HOME/lib32:$ORACLE_HOME/network/lib32:$LIBPATH
   export LIBPATH
esac
if [ "$PLATFORM" = Linux -a "$M_ARCH" = s390x ]; then
  SET_DEFAULT=NO
  LD_LIBRARY_PATH=$ORACLE_HOME/lib32:$ORACLE_HOME/network/lib32:$LD_LIBRARY_PATH
  export LD_LIBRARY_PATH
fi
case $SET_DEFAULT in "YES")
if  [ -d ${ORACLE_HOME}/lib32 ]; then
  LD_LIBRARY_PATH=$ORACLE_HOME/lib32:$ORACLE_HOME/network/lib32:$LD_LIBRARY_PATH
  export LD_LIBRARY_PATH
  LD_LIBRARY_PATH_64=$ORACLE_HOME/lib:$ORACLE_HOME/network/lib:$LD_LIBRARY_PATH_64
  export LD_LIBRARY_PATH_64
else
  LD_LIBRARY_PATH=$ORACLE_HOME/lib:$ORACLE_HOME/network/lib:$LD_LIBRARY_PATH
  export LD_LIBRARY_PATH
fi
esac

JAVA_HOME=$ORACLE_HOME/jdk
export JAVA_HOME
JAVAEXE=java

# make sure jdk is installed
if [ ! -d ${JAVA_HOME} ]; then
   echo "$JAVA_HOME not found.";
   exit -1
fi

LDAPJCLNT19=$ORACLE_HOME/jlib/ldapjclnt19.jar
# make sure ldapjclnt19.jar is present
if [ ! -f "$LDAPJCLNT19" ]; then
   echo "Missing jar file."
   echo "$LDAPJCLNT19 not found"
   exit -1 
fi

CLASSPATH=${LDAPJCLNT19}:${ORACLE_HOME}/jlib/oraclepki103.jar:$ORACLE_HOME/j2ee/home/jps-api.jar:$ORACLE_HOME/j2ee/home/jps-internal.jar

export CLASSPATH

exec ${JAVA_HOME}/bin/$JAVAEXE -Xms48m -Xmx256m -classpath ${CLASSPATH} -DORACLE_HOME=$ORACLE_HOME oracle.ldap.util.provisioning.ProvisioningProfile "$@"
